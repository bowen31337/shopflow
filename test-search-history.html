<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search History Test</title>
    <style>
        body {
            font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-section {
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .search-container {
            position: relative;
            margin: 20px 0;
        }
        .search-input {
            width: 100%;
            padding: 12px 40px 12px 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            outline: none;
        }
        .search-input:focus {
            border-color: #10B981;
        }
        .search-history {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #e5e7eb;
            border-top: none;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            z-index: 100;
        }
        .history-item {
            padding: 12px 16px;
            cursor: pointer;
            border-bottom: 1px solid #f3f4f6;
        }
        .history-item:hover {
            background: #f9fafb;
        }
        .history-header {
            padding: 12px 16px;
            background: #f9fafb;
            border-bottom: 1px solid #e5e7eb;
            font-weight: 600;
            color: #374151;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 6px;
        }
        .status.success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #a7f3d0;
        }
        .status.error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fecaca;
        }
        .test-button {
            background: #10B981;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }
        .test-button:hover {
            background: #059669;
        }
        .results {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <h1>üß™ Search History Feature Test</h1>
    <p>This test verifies the search history functionality without requiring the full application.</p>

    <div class="test-section">
        <h2>1. Manual Search History Test</h2>
        <p>Test the search history by focusing on the search input without typing.</p>

        <div class="search-container">
            <input type="text" id="testSearchInput" class="search-input" placeholder="Click here without typing to see search history...">
            <div id="testSearchHistory" class="search-history" style="display: none;"></div>
        </div>

        <div id="testStatus" class="status" style="display: none;"></div>

        <button class="test-button" onclick="simulateSearch('phone')">Simulate Search: "phone"</button>
        <button class="test-button" onclick="simulateSearch('laptop')">Simulate Search: "laptop"</button>
        <button class="test-button" onclick="simulateSearch('headphones')">Simulate Search: "headphones"</button>
        <button class="test-button" onclick="clearTestHistory()">Clear Test History</button>
    </div>

    <div class="test-section">
        <h2>2. Search History Storage Test</h2>
        <button class="test-button" onclick="testLocalStorage()">Test localStorage Operations</button>
        <div id="localStorageResults" class="results"></div>
    </div>

    <div class="test-section">
        <h2>3. Code Verification</h2>
        <p>Check that the following files have been updated:</p>
        <ul>
            <li>‚úÖ <strong>Header.jsx</strong> - Added search history state and SearchHistory component</li>
            <li>‚úÖ <strong>SearchHistory.jsx</strong> - New component for displaying search history</li>
            <li>‚úÖ <strong>Header.jsx</strong> - Updated search input handlers</li>
        </ul>
    </div>

    <script>
        let testHistory = [];

        function loadTestHistory() {
            const saved = localStorage.getItem('searchHistory');
            if (saved) {
                try {
                    testHistory = JSON.parse(saved);
                } catch (e) {
                    testHistory = [];
                }
            }
        }

        function saveTestHistory() {
            localStorage.setItem('searchHistory', JSON.stringify(testHistory.slice(0, 10)));
        }

        function updateTestHistoryDisplay() {
            const historyContainer = document.getElementById('testSearchHistory');
            const searchInput = document.getElementById('testSearchInput');

            if (testHistory.length > 0) {
                historyContainer.innerHTML = '';
                const header = document.createElement('div');
                header.className = 'history-header';
                header.textContent = 'Recent Searches';
                historyContainer.appendChild(header);

                testHistory.forEach((item, index) => {
                    const historyItem = document.createElement('div');
                    historyItem.className = 'history-item';
                    historyItem.innerHTML = 'üîç ' + item;
                    historyItem.onclick = () => {
                        searchInput.value = item;
                        historyContainer.style.display = 'none';
                        showTestStatus('Search history item selected: "' + item + '"', true);
                    };
                    historyContainer.appendChild(historyItem);
                });

                historyContainer.style.display = 'block';
            } else {
                historyContainer.style.display = 'none';
            }
        }

        function showTestStatus(message, success = true) {
            const status = document.getElementById('testStatus');
            status.textContent = message;
            status.className = 'status ' + (success ? 'success' : 'error');
            status.style.display = 'block';
        }

        function simulateSearch(query) {
            // Add to history
            testHistory = [query, ...testHistory.filter(item => item.toLowerCase() !== query.toLowerCase())];
            saveTestHistory();
            updateTestHistoryDisplay();
            showTestStatus('Search added to history: "' + query + '"', true);
        }

        function clearTestHistory() {
            testHistory = [];
            localStorage.removeItem('searchHistory');
            updateTestHistoryDisplay();
            showTestStatus('Search history cleared', true);
        }

        function testLocalStorage() {
            const results = document.getElementById('localStorageResults');

            try {
                // Test save
                const testHistory = ['test1', 'test2', 'test3'];
                localStorage.setItem('searchHistory', JSON.stringify(testHistory));

                // Test load
                const loaded = JSON.parse(localStorage.getItem('searchHistory'));

                if (JSON.stringify(testHistory) === JSON.stringify(loaded)) {
                    results.innerHTML = '<strong style="color: #065f46;">‚úÖ localStorage operations working correctly</strong><br>' +
                                       'Saved: ' + JSON.stringify(testHistory) + '<br>' +
                                       'Loaded: ' + JSON.stringify(loaded);
                } else {
                    results.innerHTML = '<strong style="color: #991b1b;">‚ùå localStorage operations failed</strong><br>' +
                                       'Saved: ' + JSON.stringify(testHistory) + '<br>' +
                                       'Loaded: ' + JSON.stringify(loaded);
                }
            } catch (error) {
                results.innerHTML = '<strong style="color: #991b1b;">‚ùå localStorage error: ' + error.message + '</strong>';
            }
        }

        // Initialize
        loadTestHistory();
        updateTestHistoryDisplay();

        // Add event listeners
        document.getElementById('testSearchInput').addEventListener('focus', function() {
            updateTestHistoryDisplay();
        });

        document.addEventListener('mousedown', function(event) {
            const historyContainer = document.getElementById('testSearchHistory');
            const searchInput = document.getElementById('testSearchInput');

            if (historyContainer.style.display === 'block' &&
                !historyContainer.contains(event.target) &&
                !searchInput.contains(event.target)) {
                historyContainer.style.display = 'none';
            }
        });

        // Test completion message
        setTimeout(() => {
            showTestStatus('Search history components implemented successfully! ‚ú®', true);
        }, 500);
    </script>
</body>
</html>